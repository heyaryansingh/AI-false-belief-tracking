---
phase: 06-tests-ci
plan: 02
type: execute
depends_on: ["06-01"]
files_modified: [tests/test_helper_agents.py]
domain: python
---

<objective>
Create comprehensive unit tests for helper agents (reactive, goal-only, belief-sensitive).

Purpose: Ensure helper agents work correctly, implement the interface properly, and produce expected behaviors. Test intervention policies and false-belief detection. These tests complement the core component tests.

Output: Test file covering all helper agent types with tests for planning, belief updates, and intervention decisions.
</objective>

<execution_context>
~/.cursor/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-tests-ci/06-01-SUMMARY.md
@src/bsa/agents/helper/reactive.py
@src/bsa/agents/helper/goal_only.py
@src/bsa/agents/helper/belief_sensitive.py
@src/bsa/agents/helper/policies.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create helper agent tests</name>
  <files>tests/test_helper_agents.py</files>
  <action>
    Create `tests/test_helper_agents.py` with comprehensive tests for helper agents:
    
    1. **ReactiveHelper tests**:
       - `test_implements_interface()`: Verify implements HelperAgent interface
       - `test_plan_action()`: Test reactive action planning (reacts to visible objects)
       - `test_update_belief()`: Test that update_belief is no-op (reactive doesn't track beliefs)
       - `test_get_belief_state()`: Test returns None (no belief state)
       - `test_detect_false_belief()`: Test returns False (reactive doesn't detect)
       - `test_reset()`: Test agent reset
    
    2. **GoalOnlyHelper tests**:
       - `test_implements_interface()`: Verify implements HelperAgent interface
       - `test_goal_inference()`: Test goal inference updates correctly
       - `test_plan_action()`: Test action planning based on inferred goal
       - `test_update_belief()`: Test updates goal inference
       - `test_get_belief_state()`: Test returns goal distribution
       - `test_detect_false_belief()`: Test returns False (assumes beliefs match true state)
       - `test_reset()`: Test agent reset
    
    3. **BeliefSensitiveHelper tests**:
       - `test_implements_interface()`: Verify implements HelperAgent interface
       - `test_belief_tracking()`: Test tracks both goal and object location beliefs
       - `test_plan_action()`: Test action planning based on beliefs
       - `test_update_belief()`: Test updates belief inference
       - `test_detect_false_belief()`: Test false-belief detection logic
       - `test_get_belief_state()`: Test returns full belief state
       - `test_intervention_policy()`: Test intervention policy decisions
       - `test_reset()`: Test agent reset
    
    4. **InterventionPolicy tests**:
       - `test_should_intervene()`: Test intervention decision logic
       - `test_choose_intervention()`: Test intervention type selection
       - `test_get_intervention_type()`: Test intervention type retrieval
    
    5. Use pytest fixtures for:
       - Sample environments
       - Sample episodes
       - Sample observations
       - Sample tasks
    
    6. Test integration with environments:
       - Test agents work with GridHouseEnvironment
       - Test agents work with VirtualHomeEnvironment (if available)
    
    Ensure tests verify correct behavior for each agent type.
  </action>
  <verify>
    Run `pytest tests/test_helper_agents.py -v` - should run all tests successfully.
    Run `pytest tests/test_helper_agents.py::TestReactiveHelper -v` - should test reactive helper.
    Run `pytest tests/test_helper_agents.py::TestBeliefSensitiveHelper -v` - should test belief-sensitive helper.
  </verify>
  <done>Helper agent tests implemented, covering all agent types and intervention policies</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] All helper agent tests pass
- [ ] Tests verify interface compliance
- [ ] Tests verify correct behavior for each agent type
- [ ] Intervention policy tests pass
- [ ] Test coverage >70% for helper agents
</verification>

<success_criteria>

- Comprehensive unit tests for all helper agent types
- Tests verify interface compliance and correct behavior
- Ready for Plan 06-03 (Experiment and analysis component tests)
  </success_criteria>

<output>
After completion, create `.planning/phases/06-tests-ci/06-02-SUMMARY.md`:

# Phase 6 Plan 2: Helper Agent Tests Summary

**Implemented comprehensive unit tests for helper agents**

## Accomplishments

- Created tests for ReactiveHelper
- Created tests for GoalOnlyHelper
- Created tests for BeliefSensitiveHelper
- Created tests for InterventionPolicy
- Tests verify interface compliance and correct behavior

## Files Created/Modified

- `tests/test_helper_agents.py` - Helper agent tests

## Decisions Made

- Test structure: Separate test classes for each agent type
- Interface testing: Verify all agents implement HelperAgent interface
- Behavior testing: Test planning, belief updates, and intervention decisions
- Integration testing: Test agents work with environments

## Issues Encountered

[Any issues with test implementation, agent behavior, etc.]

## Next Step

Ready for 06-03-PLAN.md (Experiment and analysis component tests)
</output>
